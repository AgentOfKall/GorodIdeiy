{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h3 class="mb-0">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h3>
            </div>
            <div class="card-body">
                <div class="row mb-4">
                    <div class="col-md-3 text-center">
                        <div class="mb-3">
                            <div class="display-1">üë§</div>
                        </div>
                    </div>
                    <div class="col-md-9">
                        <h4>{{ user.username }}</h4>
                        <p class="text-muted">{{ user.email }}</p>
                        <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> {{ user.created_at[:10] if user.created_at else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}</p>
                        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> 
                            {% if user.is_admin %}
                            <span class="badge bg-danger">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                            {% else %}
                            <span class="badge bg-secondary">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                            {% endif %}
                        </p>
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <h4>{{ user_stats.ideas_count }}</h4>
                                <p class="text-muted">–ú–æ–∏ –∏–¥–µ–∏</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <h4>{{ user_stats.votes_count }}</h4>
                                <p class="text-muted">–ú–æ–∏ –≥–æ–ª–æ—Å–∞</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <h4>{{ user_stats.comments_count }}</h4>
                                <p class="text-muted">–ú–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h4>–ú–æ–∏ –∏–¥–µ–∏</h4>
                {% if ideas %}
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–ì–æ–ª–æ—Å–∞</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for idea in ideas %}
                            <tr>
                                <td>
                                    <a href="{{ url_for('idea_detail', idea_id=idea.id) }}">{{ idea.title[:30] }}{% if idea.title|length > 30 %}...{% endif %}</a>
                                </td>
                                <td><span class="badge bg-secondary">{{ idea.category }}</span></td>
                                <td>
                                    <span class="badge bg-{{ 'success' if idea.status == 'approved' else 'warning' if idea.status == 'pending' else 'danger' }}">
                                        {{ '–û–¥–æ–±—Ä–µ–Ω–æ' if idea.status == 'approved' else '–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏' if idea.status == 'pending' else '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ' }}
                                    </span>
                                </td>
                                <td>{{ idea.votes_count }}</td>
                                <td>{{ idea.created_at[:10] }}</td>
                                <td>
                                    <div class="btn-group btn-group-sm">
                                        <a href="{{ url_for('idea_detail', idea_id=idea.id) }}" class="btn btn-info">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                                        <a href="{{ url_for('delete_idea', idea_id=idea.id) }}" 
                                           class="btn btn-danger"
                                           onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∏–¥–µ—é \"{{ idea.title }}\"?')">
                                            üóëÔ∏è
                                        </a>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="alert alert-info">
                    –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –∏–¥–µ–π. <a href="{{ url_for('add_idea') }}">–ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –ø–µ—Ä–≤—É—é!</a>
                </div>
                {% endif %}
                
                {% if user_stats.ideas_by_status %}
                <div class="mt-4">
                    <h5>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–∏—Ö –∏–¥–µ–π</h5>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body text-center">
                                    <h4>{{ user_stats.ideas_by_status.get('approved', 0) }}</h4>
                                    <p>–û–¥–æ–±—Ä–µ–Ω–æ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body text-center">
                                    <h4>{{ user_stats.ideas_by_status.get('pending', 0) }}</h4>
                                    <p>–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-danger text-white">
                                <div class="card-body text-center">
                                    <h4>{{ user_stats.ideas_by_status.get('rejected', 0) }}</h4>
                                    <p>–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body text-center">
                                    <h4>{{ user_stats.ideas_by_status.get('implemented', 0) }}</h4>
                                    <p>–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
